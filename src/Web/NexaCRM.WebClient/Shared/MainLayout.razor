@inherits LayoutComponentBase
@using NexaCRM.WebClient.Shared
@inject IJSRuntime JSRuntime

<div class="page">
    <!-- ê³ ì •ëœ í–„ë²„ê±° ë²„íŠ¼ - sidebar ë°–ì— ë°°ì¹˜ -->
    <button title="Navigation menu" class="floating-menu-toggle" @onclick="ToggleNavMenu">
        <span class="navbar-toggler-icon"></span>
    </button>
    
    <!-- Theme Toggle Button -->
    <button title="Toggle theme" class="theme-toggle-button" data-theme-toggle aria-label="Switch theme">
        <span class="theme-light-icon">ğŸŒ</span>
        <span class="theme-dark-icon">ğŸŒ™</span>
    </button>
    
    <div class="sidebar">
        <NavMenu />
    </div>
    <div class="mobile-overlay" @onclick="() => {}"></div>
    <main>
        <article class="content px-4 page-fade-enter">
            @Body
        </article>
    </main>
    

</div>

@code {
    private bool collapseNavMenu = true;

    private async Task ToggleNavMenu()
    {
        collapseNavMenu = !collapseNavMenu;
        // JavaScript í•¨ìˆ˜ í˜¸ì¶œí•˜ì—¬ UI ì—…ë°ì´íŠ¸
        await JSRuntime.InvokeVoidAsync("window.navigationHelper.toggleMenu", collapseNavMenu);
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            // ì´ˆê¸° ë Œë”ë§ í›„ JavaScript ì´ˆê¸°í™”
            await JSRuntime.InvokeVoidAsync("window.navigationHelper.setupOverlayHandler");
            // ì´ˆê¸° ìƒíƒœë¥¼ í™•ì‹¤íˆ ì„¤ì • (ë©”ë‰´ ë‹«íŒ ìƒíƒœ)
            await JSRuntime.InvokeVoidAsync("window.navigationHelper.toggleMenu", true);
        }
    }
}
