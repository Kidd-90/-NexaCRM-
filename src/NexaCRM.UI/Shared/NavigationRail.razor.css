/* Navigation Rail - responsive icon rail + detail panel */
.nav-rail {
    display: grid;
    /* icons column + panel (panel made slightly narrower for visual balance) */
    grid-template-columns: 56px minmax(180px, 1fr);
    gap: 0;
    /* Fix the rail to the left side of the viewport so it doesn't move on page scroll */
     position: fixed;
     /* offset the rail slightly to match the main surface top padding so
         the panel and surface align visually */
    top: calc(var(--spacing-md) / 2);
    left: 0;
    bottom: 0;
    height: 100vh;
     /* Use the app's shared sidebar width variable so the fixed rail and the
         main content offset remain in sync. This prevents the fixed rail from
         contributing to horizontal overflow. */
    width: var(--sidebar-width, 320px);
    --nav-rail-icons-width: 56px; /* logical width of the icons column - used for centering fixed logo */
     /* enforce box-sizing and prevent the rail from causing document overflow */
     box-sizing: border-box;
     overflow: hidden; /* Prevent internal content from expanding beyond the rail */
     min-width: 56px; /* ensure collapsed baseline */
     max-width: var(--sidebar-width, 320px);
}

/* Ensure the nav rail sits above common overlays (mobile overlay, global actions)
   and accepts pointer events so icon clicks are not blocked. Keep this modest
   to avoid covering toasts and modal backdrops which intentionally sit above. */
.nav-rail {
    /* Keep a high stacking context so the rail stays interactive above
       most app overlays. When fixed it should still accept pointer events. */
    z-index: 20000;
    pointer-events: auto;
}

/* When collapsed, constrain the rail to a narrow column so the app content
   is not obscured. The panel (second column) will be effectively hidden. */
.nav-rail.collapsed {
    grid-template-columns: 56px 0px !important;
    width: 56px !important;
}

/* --- Icon Column : Layered rail inspired by concept mockup --- */
.nav-rail__icons {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    padding: 1.4rem 1.1rem 1.9rem;
    gap: 0;
    min-width: 56px; /* icons column must never grow to force overflow */
    box-sizing: border-box;
    position: relative;
    overflow: visible;
    pointer-events: auto;
}

.nav-rail__layer {
    position: relative;
    flex: 1 1 auto;
    display: flex;
    flex-direction: column;
    align-items: stretch;
    justify-content: flex-start;
    border-radius: 40px;
    padding: 22px 12px 118px;
    background: linear-gradient(200deg, rgba(15, 18, 31, 0.92) 0%, rgba(29, 36, 50, 0.94) 44%, rgba(57, 67, 87, 0.88) 100%);
    box-shadow: 0 28px 54px rgba(8, 15, 34, 0.36), inset 0 1px 0 rgba(255, 255, 255, 0.12);
    overflow: visible;
}

.nav-rail__layer::before {
    content: "";
    position: absolute;
    inset: -10px;
    border-radius: 48px;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.96) 0%, rgba(226, 232, 240, 0.88) 100%);
    transform: translateY(18px);
    filter: blur(0.4px);
    box-shadow: 0 26px 46px rgba(15, 23, 42, 0.24);
    z-index: -2;
    pointer-events: none;
}

.nav-rail__layer::after {
    content: "";
    position: absolute;
    inset-inline: -34px;
    inset-block-start: -70px;
    height: 180px;
    background: radial-gradient(120% 74% at 50% 0%, rgba(186, 230, 253, 0.42) 0%, rgba(59, 130, 246, 0) 70%);
    opacity: 0.85;
    filter: blur(12px);
    z-index: -3;
    pointer-events: none;
}

.nav-rail__layer-sheen {
    position: absolute;
    inset: 12px 12px 104px;
    border-radius: 32px;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.18) 0%, rgba(255, 255, 255, 0.04) 46%, rgba(148, 163, 184, 0.05) 100%);
    border: 1px solid rgba(226, 232, 240, 0.12);
    mix-blend-mode: screen;
    pointer-events: none;
    z-index: 0;
}

.nav-rail__layer-content {
    position: relative;
    z-index: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.9rem;
    padding: 0.35rem 0.35rem 0;
    height: 100%;
    flex: 1 1 auto;
}

.nav-rail__top {
    width: 100%;
    display: flex;
    justify-content: center;
    margin-bottom: 0.35rem;
}

.nav-rail__clusters {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    gap: 1.05rem;
    width: 100%;
    flex: 1 1 auto;
}

.nav-rail__stack {
    display: flex;
    flex-direction: column;
    width: 100%;
    align-items: center;
    gap: 0.65rem;
    flex: 1 1 auto;
    overflow-y: auto;
    padding-inline: 0.1rem;
}

.nav-rail__stack--top {
    padding-bottom: 0.25rem;
}

.nav-rail__stack--bottom {
    flex: 0 0 auto;
    overflow-y: visible;
    padding-top: 0.15rem;
}

.nav-rail__divider {
    width: 100%;
    height: 1px;
    border-radius: 999px;
    background: linear-gradient(90deg, rgba(255, 255, 255, 0) 0%, rgba(148, 163, 184, 0.52) 45%, rgba(255, 255, 255, 0) 100%);
    opacity: 0.75;
}

.nav-rail__stack::-webkit-scrollbar {
    width: 0;
    height: 0;
}

.rail-icon {
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
    width: 46px;
    height: 46px;
    display: grid;
    place-items: center;
    border-radius: 16px;
    border: 1px solid rgba(226, 232, 240, 0.12);
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.02) 100%);
    color: rgba(248, 250, 252, 0.8);
    font-size: 1.1rem;
    transition: transform var(--transition-fast), box-shadow var(--transition-fast), background-color var(--transition-fast), color var(--transition-fast), border-color var(--transition-fast);
    cursor: pointer;
    overflow: visible;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    box-shadow: 0 10px 24px rgba(15, 23, 42, 0.16);
}

.rail-icon:hover {
    background: linear-gradient(180deg, rgba(244, 244, 249, 0.22) 0%, rgba(203, 213, 225, 0.14) 100%);
    border-color: rgba(248, 250, 252, 0.42);
    color: #F8FAFC;
    transform: translateY(-2px);
    box-shadow: 0 20px 32px rgba(15, 23, 42, 0.25);
}

.rail-icon:active {
    transform: translateY(0);
    box-shadow: 0 10px 20px rgba(15, 23, 42, 0.18);
}

.rail-icon.active {
    border-color: rgba(248, 250, 252, 0.55);
    color: #FFFFFF;
    background: linear-gradient(200deg, rgba(79, 70, 229, 0.8) 0%, rgba(129, 140, 248, 0.58) 50%, rgba(196, 181, 253, 0.45) 100%);
    box-shadow: 0 24px 40px rgba(76, 29, 149, 0.35), inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

/* Slight hover feedback on the icon glyph */
.rail-icon i,
.rail-icon svg {
    transition: transform var(--transition-fast), color var(--transition-fast);
    font-size: 1.25rem; /* slightly larger to fill the 44px button */
    line-height: 1;
    display: inline-block;
    color: inherit;
    width: 1em;
    height: 1em;
}

/* Make only the profile button fully round */
.rail-icon--profile {
    border-radius: 999px;
    position: relative; /* for positioning the status dot */
}

/* Green login indicator dot at bottom-right of the profile icon */
.rail-icon--profile .indicator-dot {
    position: absolute;
    width: 10px;
    height: 10px;
    border-radius: 999px;
    background: #10B981; /* emerald-500 */
    left: 25px;
    box-shadow: 0 0 0 2px #FFFFFF; /* white ring to separate from background */
    pointer-events: none;
}

.rail-spacer {
    flex: 1 1 auto;
}

.nav-rail__bottom {
    margin-top: auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.75rem;
    padding-bottom: 72px; /* reserve space for floating logo badge */
    position: relative;
    z-index: 2;
}

/* Company logo button at the very bottom of the rail */
.rail-logo--company {
    display: grid;
    place-items: center;
    width: 52px;
    height: 52px;
    position: absolute;
    left: 50%;
    bottom: 12px;
    transform: translateX(-50%);
    z-index: 3;
    border-radius: 18px;
    overflow: hidden;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.92) 0%, rgba(226, 232, 240, 0.84) 100%);
    box-shadow: 0 16px 34px rgba(15, 23, 42, 0.28), inset 0 1px 0 rgba(255, 255, 255, 0.35);
}
.rail-logo--company img {
    width: 30px;
    height: 30px;
    object-fit: contain;
}

.nav-rail__release {
    position: absolute;
    right: -42px;
    bottom: 120px;
    transform: rotate(-90deg);
    transform-origin: center right;
    display: flex;
    align-items: center;
    gap: 1.25rem;
    font-size: 0.68rem;
    letter-spacing: 0.38em;
    text-transform: uppercase;
    color: rgba(226, 232, 240, 0.62);
    z-index: 1;
    pointer-events: none;
}

.nav-rail__release-label {
    font-weight: 600;
    opacity: 0.9;
}

.nav-rail__status {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.3rem 1.35rem;
    border-radius: 999px;
    border: 1px solid rgba(248, 250, 252, 0.32);
    background: linear-gradient(180deg, rgba(148, 163, 184, 0.35) 0%, rgba(148, 163, 184, 0.08) 100%);
    color: #F8FAFC;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.24em;
}

@media (max-width: 1024px) {
    .nav-rail__release {
        display: none;
    }
}

.rail-logo {
    display: grid;
    place-items: center;
    width: 46px;
    height: 46px;
    border-radius: 16px;
    border: 1px solid rgba(248, 250, 252, 0.36);
    background: linear-gradient(180deg, rgba(248, 250, 252, 0.28) 0%, rgba(226, 232, 240, 0.16) 100%);
    overflow: hidden;
    order: 0; /* keep top logo at natural position */
    position: static;
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.45);
}

.rail-logo img {
    width: 22px;
    height: 22px;
    object-fit: contain;
}

.nav-rail__panel {
    min-width: 0;
    /* brand gradient vars used for the subtle purple glow */
    --brand-gradient-start: #7c3aed;
    --brand-gradient-end: #9333ea;

    padding: 0.5rem 0.5rem 0.75rem 0.5rem; /* reduced padding to match surface */
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    /* Harmonize with the main surface: use the same surface color and subtle
       border so the rail panel feels like part of the same UI plane. Remove
       harsh contrasts and ensure scroll behavior remains internal. */
    background: var(--surface-color, #FFFFFF);
    border: 1px solid var(--divider-color, #E5E7EB);
    border-radius: 1rem;
    overflow-y: auto; /* make the list scrollable if it's taller than the panel */
    max-height: calc(100vh - 2 * var(--spacing-md)); /* leave top/bottom breathing room */
    box-sizing: border-box;
    /* slightly narrower max width to give visual space between rail and content */
    max-width: calc(var(--sidebar-width, 320px) - 72px);
    /* 3D layered shadow: ambient, main drop, colored rim (purple) */
    box-shadow:
        0 6px 12px rgba(15, 23, 42, 0.04),   /* ambient */
        0 20px 40px rgba(15, 23, 42, 0.08),  /* main drop */
        4px 6px 28px rgba(124, 58, 237, 0.06); /* subtle purple rim */
    opacity: 1;
    transform: translateX(0);
    transition:
        box-shadow 240ms cubic-bezier(.2,.9,.2,1),
        transform 240ms cubic-bezier(.2,.9,.2,1),
        opacity 200ms ease;
    position: relative; /* for pseudo-elements (highlight + glow) */
    will-change: transform, box-shadow, opacity;
}

/* gradient glow using a pseudo-element so we can control the spread and color smoothly */
.nav-rail__panel::after {
    content: "";
    pointer-events: none;
    position: absolute;
    /* larger, softer glow ellipse to emphasize lower-right rim */
    right: -18px;
    bottom: -18px;
    width: 68px;
    height: 48px;
    border-radius: 50%;
    background: radial-gradient(ellipse at center, rgba(124,58,237,0.16) 0%, rgba(147,51,234,0.08) 40%, transparent 70%);
    filter: blur(18px);
    opacity: 0.95;
    transform: translateZ(0) scale(1);
    transition: opacity 240ms ease, transform 240ms ease, filter 240ms ease;
}

/* soft top-left highlight to simulate a light source */
.nav-rail__panel::before {
    content: "";
    pointer-events: none;
    position: absolute;
    left: 8px;
    top: 8px;
    right: 8px;
    height: 10px;
    border-radius: 8px;
    background: linear-gradient(180deg, rgba(255,255,255,0.16), rgba(255,255,255,0.02));
    filter: blur(6px);
    opacity: 0.9;
    transition: opacity 220ms ease, transform 220ms ease;
}

/* Hover: lift the panel slightly and intensify shadows/glow for a floating 3D feel */
.nav-rail__panel:hover {
    transform: translateY(-6px);
    box-shadow:
        0 14px 28px rgba(15,23,42,0.06),
        0 34px 64px rgba(15,23,42,0.12),
        8px 12px 44px rgba(124,58,237,0.10);
}
.nav-rail__panel:hover::after {
    transform: translateY(-6px) scale(1.06);
    filter: blur(20px);
    opacity: 1;
}
.nav-rail__panel:hover::before {
    transform: translateY(-2px);
    opacity: 1;
}

/* When panel is collapsed, hide shadow/glow to avoid orphaned visuals */
.nav-rail__panel.collapsed {
    transform: translateX(-16px) scale(0.98);
    box-shadow: none !important;
}
.nav-rail__panel.collapsed::after {
    opacity: 0 !important;
    transform: translateY(6px) scale(0.9) !important;
}

.nav-rail__panel:not(.collapsed) {
    animation: railPanelReveal 320ms cubic-bezier(.2,.9,.2,1) 40ms both;
}

@keyframes railPanelReveal {
    0% {
        opacity: 0;
        transform: translateX(-18px) scale(0.96);
    }
    60% {
        opacity: 1;
        transform: translateX(3px) scale(1.01);
    }
    100% {
        opacity: 1;
        transform: translateX(0) scale(1);
    }
}

/* reduce intensity on smaller screens to improve performance and avoid visual noise */
@media (max-width: 767px) {
    .nav-rail__panel {
        box-shadow: 0 10px 18px rgba(15,23,42,0.04);
    }
    .nav-rail__panel::after {
        opacity: 0.6;
        filter: blur(8px);
        right: -8px;
        bottom: -8px;
        width: 28px;
        height: 28px;
    }
}

.nav-rail__panel.collapsed {
    width: 0 !important;
    min-width: 0 !important;
    padding: 0 !important;
    opacity: 0;
    transform: translateX(-16px) scale(0.96);
    pointer-events: none;
}

/* Keep internal scrolling behavior (so the rail doesn't force body/document scrolling)
   but hide the native scrollbars so the rail visually has no scroll UI. This
   preserves wheel/touch scrolling while preventing visible scrollbars. */
.nav-rail__icons,
.nav-rail__panel {
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
}
.nav-rail__icons::-webkit-scrollbar,
.nav-rail__panel::-webkit-scrollbar {
    width: 0;
    height: 0;
}

.panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.75rem;
    padding: 0.5rem 0.35rem 0.75rem 0.35rem;
    border-bottom: 1px solid #E5E7EB;
}

/* When in DB panel, place the import button beneath the title */
.panel-header--db {
    flex-wrap: wrap;
    align-items: flex-start;
}

.panel-header--db .panel-title {
    flex: 1 0 100%;
}

.panel-header--db .import-button {
    margin-top: 0.35rem;
}

.panel-title {
    font-weight: 700;
    color: #111827; /* solid title */
}

.panel-action {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.35rem 0.6rem;
    border-radius: 10px;
    border: 1px solid #E5E7EB;
    background: #F9FAFB;
    color: #6B7280;
    font-weight: 600;
}

.panel-action:hover {
    color: #111827;
    background: #FFFFFF;
}

/* Import button variant for DB panel */
.panel-action.import-button {
    background: #ECFDF5; /* emerald-50 */
    border-color: #A7F3D0; /* emerald-200 */
    color: #065F46; /* emerald-800 */
}

.panel-action.import-button:hover {
    background: #D1FAE5; /* emerald-100 */
    border-color: #6EE7B7; /* emerald-300 */
    color: #064E3B; /* emerald-900 */
}

.panel-action.import-button i {
    font-size: 1rem;
}

/* Divider above the first item in DB panel */
.panel-divider {
    border-top: 1px solid #E5E7EB;
    margin: 0.25rem 0 0.4rem 0;
}

.panel-section-label {
    padding: 0.6rem 0.35rem 0.25rem 0.35rem;
    color: #9CA3AF; /* muted label */
    font-size: 0.8rem;
    letter-spacing: 0.02em;
    text-transform: uppercase;
}

.panel-list {
    display: flex;
    flex-direction: column;
    gap: 0.4rem;
    padding: 0.25rem 0.25rem 0.5rem 0.25rem;
}

.rail-panel-item {
    position: relative;
    display: grid;
    grid-template-columns: 40px minmax(0, 1fr);
    align-items: center;
    column-gap: 0.75rem;
    padding: 0.55rem 0.75rem;
    border-radius: 14px;
    min-height: 44px;
    color: #1F2937;
    font-weight: 600;
    text-decoration: none;
    background: transparent;
    box-shadow: inset 0 0 0 0 rgba(148,163,184,0.18);
    transition: transform 200ms cubic-bezier(.2,.9,.2,1),
                color 180ms ease,
                box-shadow 220ms ease,
                background-color 180ms ease;
    isolation: isolate;
}

.rail-panel-item::before {
    content: "";
    position: absolute;
    inset: 4px;
    border-radius: 12px;
    background: linear-gradient(130deg, rgba(124,58,237,0.12), rgba(59,130,246,0.08));
    opacity: 0;
    transform: scale(0.92);
    transition: opacity 220ms ease, transform 220ms cubic-bezier(.2,.9,.2,1);
    z-index: -1;
}

.rail-panel-item::after {
    content: "";
    position: absolute;
    left: 10px;
    top: 14px;
    bottom: 14px;
    width: 3px;
    border-radius: 999px;
    background: linear-gradient(180deg, rgba(124,58,237,0.0), rgba(124,58,237,0.4), rgba(124,58,237,0.0));
    opacity: 0;
    transform: scaleY(0.4);
    transition: opacity 200ms ease, transform 220ms cubic-bezier(.2,.9,.2,1);
}

.rail-panel-item:hover,
.rail-panel-item:focus-visible {
    color: #4C1D95;
    transform: translateX(4px);
    box-shadow: inset 0 0 0 1px rgba(76,29,149,0.08), 0 8px 18px rgba(76,29,149,0.08);
}

.rail-panel-item:hover::before,
.rail-panel-item:focus-visible::before {
    opacity: 1;
    transform: scale(1);
}

.rail-panel-item:hover::after,
.rail-panel-item:focus-visible::after {
    opacity: 1;
    transform: scaleY(1);
}

.rail-panel-item:focus-visible {
    outline: none;
}

.rail-panel-item.active,
.rail-panel-item.active:hover {
    color: #4C1D95;
    background: linear-gradient(120deg, rgba(236,233,254,0.9), rgba(250,245,255,0.95));
    box-shadow: inset 0 0 0 1px rgba(76,29,149,0.16), 0 14px 28px rgba(76,29,149,0.10);
}

.rail-panel-item.active::before {
    opacity: 1;
    transform: scale(1);
}

.rail-panel-item.active::after {
    opacity: 1;
    transform: scaleY(1);
    background: linear-gradient(180deg, rgba(76,29,149,0.15), rgba(124,58,237,0.45), rgba(59,130,246,0.15));
}

.rail-panel-item__icon {
    width: 38px;
    height: 38px;
    display: grid;
    place-items: center;
    border-radius: 10px;
    background: rgba(241,245,249,0.7);
    color: inherit;
    transition: transform 200ms cubic-bezier(.2,.9,.2,1), background-color 180ms ease;
}

.rail-panel-item:hover .rail-panel-item__icon,
.rail-panel-item:focus-visible .rail-panel-item__icon,
.rail-panel-item.active .rail-panel-item__icon {
    background: rgba(250,245,255,0.95);
    transform: translateX(2px);
}

.rail-panel-item__icon i,
.rail-panel-item__icon svg {
    font-size: 1.15rem;
    line-height: 1;
    transition: transform 200ms cubic-bezier(.2,.9,.2,1);
}

.rail-panel-item:hover .rail-panel-item__icon i,
.rail-panel-item:focus-visible .rail-panel-item__icon i,
.rail-panel-item.active .rail-panel-item__icon i {
    transform: scale(1.05);
}

.rail-panel-item__label {
    display: block;
    min-width: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    font-size: 0.95rem;
}

@media (prefers-reduced-motion: reduce) {
    .nav-rail__panel {
        animation: none !important;
        transform: none !important;
    }

    .rail-panel-item,
    .rail-panel-item::before,
    .rail-panel-item::after,
    .rail-panel-item__icon,
    .rail-panel-item__icon i {
        transition-duration: 0.01ms !important;
        transition-delay: 0s !important;
        transform: none !important;
    }
}

/* Breakpoints: keep rail+panel for mobile and tablet */
@media (max-width: 767px) {
    .nav-rail {
        grid-template-columns: 56px minmax(220px, calc(var(--sidebar-width, 320px) - 56px));
        /* On small screens allow the rail to expand (no max-width) */
        max-width: none;
    }
}

@media (min-width: 768px) and (max-width: 1024px) {
    .nav-rail {
        grid-template-columns: 64px minmax(260px, 1fr);
    }
    .rail-icon { width: 44px; height: 44px; }
}
