@using NexaCRM.Services.Admin.Models.Db
@using Microsoft.Extensions.Localization
@inject IStringLocalizer<DbStatus> StatusLocalizer

<tr>
    <td>@Customer.CustomerName</td>
    <td>@Customer.ContactNumber</td>
    <td>@Customer.Group</td>
    <td>@Customer.AssignedTo</td>
    <td>@Customer.AssignedDate.ToShortDateString()</td>
    <td class="@GetStatusClass(Customer.Status)">@StatusLocalizer[Customer.Status.ToString()]</td>
    <td>@Customer.LastContactDate.ToShortDateString()</td>
    <td class="text-end">
        @if (IsDeleting)
        {
            <span class="text-muted">ÏÇ≠Ï†ú Ï§ë...</span>
        }
        else
        {
            <button type="button" 
                    class="btn btn-link text-danger p-0" 
                    title="ÏÇ≠Ï†ú"
                    disabled="@IsDeleting">
                    @* @onclick="OnDeleteClick"> *@
                <span class="visually-hidden">ÏÇ≠Ï†ú</span>
                <span aria-hidden="true">üóëÔ∏è</span>
            </button>
        }
    </td>
</tr>

@code {
    [Parameter]
    public DbCustomer Customer { get; set; } = default!;

    [Parameter]
    public bool IsDeleting { get; set; }

    [Parameter]
    public EventCallback<DbCustomer> OnDelete { get; set; }

    private async Task OnDeleteClick()
    {
        await OnDelete.InvokeAsync(Customer);
    }

    private static string GetStatusClass(DbStatus status) => status switch
    {
        DbStatus.New => "status-text status-new",
        DbStatus.InProgress => "status-text status-inprogress",
        DbStatus.NoAnswer => "status-text status-noanswer",
        DbStatus.Completed => "status-text status-completed",
        DbStatus.OnHold => "status-text status-onhold",
        _ => "status-text"
    };
}
