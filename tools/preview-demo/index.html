<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Preview Demo â€” NexaCRM</title>
  <link href="https://unpkg.com/filepond@4/dist/filepond.css" rel="stylesheet" />
  <link href="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css" rel="stylesheet" />
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; padding: 24px; }
    .col { display:flex; gap:16px; }
    .panel { border:1px solid #e6e6e6; padding:12px; border-radius:8px; flex:1; min-height:280px }
    canvas { max-width:100%; height:auto; }
    .visually-hidden { position: absolute !important; height: 1px; width: 1px; overflow: hidden; clip: rect(1px, 1px, 1px, 1px); white-space: nowrap; }
  </style>
</head>
<body>
  <h1>Preview Demo</h1>
  <p>Drop an image, PDF, or DOCX file into the appropriate area to preview.</p>

  <div class="col">
    <div class="panel">
      <h3>Image (FilePond)</h3>
  <label for="imageInput" class="visually-hidden">Image file</label>
  <input type="file" id="imageInput" title="Image file" />
      <div id="imagePreview"></div>
    </div>

    <div class="panel">
      <h3>PDF (pdf.js)</h3>
  <label for="pdfInput" class="visually-hidden">PDF file</label>
  <input type="file" id="pdfInput" accept="application/pdf" title="PDF file" />
      <div id="pdfPreview"></div>
    </div>

    <div class="panel">
      <h3>DOCX (Mammoth)</h3>
  <label for="docxInput" class="visually-hidden">DOCX file</label>
  <input type="file" id="docxInput" accept="application/vnd.openxmlformats-officedocument.wordprocessingml.document" title="DOCX file" />
      <div id="docxPreview"></div>
    </div>
  </div>

  <script src="https://unpkg.com/filepond@4/dist/filepond.js"></script>
  <script src="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js"></script>
  <script src="https://unpkg.com/pdfjs-dist/build/pdf.js"></script>
  <script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>
  <script>
    // FilePond image preview
    FilePond.registerPlugin(FilePondPluginImagePreview);
    const pond = FilePond.create(document.getElementById('imageInput'));

    pond.on('addfile', (err, file) => {
      if (err) return console.error(err);
      document.getElementById('imagePreview').innerHTML = '<p>Preview shown inline by FilePond above.</p>';
    });

    // PDF preview
    const pdfInput = document.getElementById('pdfInput');
    pdfInput.addEventListener('change', (e) => {
      const f = e.target.files[0];
      if (!f) return;
      const url = URL.createObjectURL(f);
      const container = document.getElementById('pdfPreview');
      container.innerHTML = '';
      const canvas = document.createElement('canvas');
      container.appendChild(canvas);
      pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://unpkg.com/pdfjs-dist/build/pdf.worker.js';
      pdfjsLib.getDocument(url).promise.then(doc => doc.getPage(1)).then(page => {
        const viewport = page.getViewport({ scale: 1.0 });
        canvas.width = viewport.width; canvas.height = viewport.height;
        page.render({ canvasContext: canvas.getContext('2d'), viewport });
      });
    });

    // DOCX preview with Mammoth
    const docxInput = document.getElementById('docxInput');
    docxInput.addEventListener('change', (e) => {
      const f = e.target.files[0];
      if (!f) return;
      const reader = new FileReader();
      reader.onload = function(event) {
        const arrayBuffer = event.target.result;
        mammoth.convertToHtml({arrayBuffer: arrayBuffer}).then(result => {
          document.getElementById('docxPreview').innerHTML = result.value;
        }).catch(err => {
          document.getElementById('docxPreview').textContent = 'Unable to preview DOCX: ' + err;
        });
      };
      reader.readAsArrayBuffer(f);
    });
  </script>
</body>
</html>